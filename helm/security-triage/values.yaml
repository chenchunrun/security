# Copyright 2026 CCR <chenchunrun@gmail.com>
#
# Default values for security-triage Helm chart
# This is a YAML-formatted file.

global:
  imageRegistry: ""
  imageTag: "latest"
  storageClass: "fast-ssd"
  environment: "production"

  # Database configuration
  database:
    host: "postgres-primary"
    port: 5432
    name: "security_triage"
    user: "postgres"
    password: "CHANGE_ME"
    poolSize: 20
    maxOverflow: 40
    sslMode: "require"

  # Redis configuration
  redis:
    host: "redis"
    port: 6379
    password: "CHANGE_ME"
    db: 0
    cluster:
      enabled: true
      replicas: 1

  # RabbitMQ configuration
  rabbitmq:
    host: "rabbitmq-ha"
    port: 5672
    user: "admin"
    password: "CHANGE_ME"
    vhost: "/"

  # LLM configuration
  llm:
    provider: "zhipu"
    zhipu:
      apiKey: ""
      model: "glm-4-flash"
      baseURL: "https://open.bigmodel.cn/api/paas/v4/"
    deepseek:
      apiKey: ""
      model: "deepseek-chat"
      baseURL: "https://api.deepseek.com"
    qwen:
      apiKey: ""
      model: "qwen-plus"
      baseURL: "https://dashscope.aliyuncs.com/compatible-mode/v1"
    openai:
      apiKey: ""
      model: "gpt-4"
      baseURL: "https://api.openai.com/v1"

  # Threat Intel API Keys
  threatIntel:
    virustotal:
      apiKey: ""
    otx:
      apiKey: ""

# Enable/disable components
components:
  alertIngestor:
    enabled: true
    replicaCount: 3
    autoscaling:
      enabled: true
      minReplicas: 3
      maxReplicas: 10
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

  webDashboard:
    enabled: true
    replicaCount: 3
    ingress:
      enabled: true
      className: "nginx"
      host: "security-triage.example.com"
      tls:
        enabled: true
        secretName: "web-dashboard-tls"
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

  aiTriageAgent:
    enabled: true
    replicaCount: 2
    resources:
      requests:
        memory: "512Mi"
        cpu: "500m"
      limits:
        memory: "1Gi"
        cpu: "1000m"

  contextCollector:
    enabled: true
    replicaCount: 2
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

  threatIntelAggregator:
    enabled: true
    replicaCount: 2
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

  similaritySearch:
    enabled: true
    replicaCount: 1
    persistence:
      enabled: true
      size: 20Gi
    resources:
      requests:
        memory: "1Gi"
        cpu: "500m"
      limits:
        memory: "2Gi"
        cpu: "1000m"

  workflowEngine:
    enabled: true
    replicaCount: 2
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

  automationOrchestrator:
    enabled: true
    replicaCount: 1
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

  notificationService:
    enabled: true
    replicaCount: 2
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
      limits:
        memory: "256Mi"
        cpu: "250m"

# PostgreSQL HA configuration
postgresql:
  enabled: true
  primary:
    replicaCount: 1
    persistence:
      enabled: true
      size: 50Gi
    resources:
      requests:
        memory: "1Gi"
        cpu: "500m"
      limits:
        memory: "2Gi"
        cpu: "1000m"
  replicas:
    replicaCount: 2
    persistence:
      size: 50Gi
  replication:
    password: "CHANGE_ME_REPLICATION_PASSWORD"

# Redis Cluster configuration
redis:
  enabled: true
  cluster:
    enabled: true
    nodes: 6
    replicas: 1
  sentinel:
    enabled: true
    replicas: 3
  persistence:
    enabled: true
    size: 10Gi
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"

# RabbitMQ Cluster configuration
rabbitmq:
  enabled: true
  replicaCount: 3
  persistence:
    enabled: true
    size: 10Gi
  management:
    enabled: true
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi"
      cpu: "1000m"

# Monitoring configuration
monitoring:
  prometheus:
    enabled: true
    serviceMonitor:
      enabled: true
  grafana:
    enabled: true
    dashboard:
      enabled: true

# Logging configuration
logging:
  enabled: true
  elasticsearch:
    enabled: false
  loki:
    enabled: true

# Security
security:
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000
  networkPolicy:
    enabled: true
